@{
    ViewBag.Title = "Build Your Video!";
}

@section scripts
{
    <script type="text/javascript">
        require(["viewModels/buildViewModel", "jquery", "knockout", "bootstrap", "bootstrapWizard"],
            function (buildVm, $, ko) {
                $(function() {
                    $('#rootwizard').bootstrapWizard({'tabClass': 'nav nav-pills build-nav-pills'});
                });
                var data = {}, vm;
                data.TemplateScripts = @Html.Raw(ViewBag.TemplateScriptsJson);
                data.StockVideos = @Html.Raw(ViewBag.StockVideosJson);
                data.StockAudio = @Html.Raw(ViewBag.StockAudioJson);
                data.CustomerResources = @Html.Raw(ViewBag.CustomerResourcesJson);
                vm = new buildVm(data);
                ko.applyBindings(vm);
                vm.SetActive('intro');
            });
    </script>
}

@section headerNav
{
    @Html.Partial("_BuildCrumbs")
}

<!-- Jumbotron -->
<div class="jumbotron">
    <p class="lead">Choose items below to build your video</p>
    <label>Name:</label>
    <input type="text" data-bind="value: Video().Name" />
</div>

<hr />

<div id="rootwizard">
	<ul>
	  	<li><a href="#tab1" data-toggle="tab" data-bind="click: function () { SetActive('intro'); }">Intro</a></li>
		<li><a href="#tab2" data-toggle="tab" data-bind="click: function () { SetActive('middle'); }">Middle</a></li>
		<li><a href="#tab3" data-toggle="tab" data-bind="click: function () { SetActive('ending'); }">Ending</a></li>
		<li><a href="#tab4" data-toggle="tab" data-bind="click: function () { SetActive('audio'); }">Audio</a></li>
		<li><a href="#tab5" data-toggle="tab">Generate!</a></li>
	</ul>
	<div class="tab-content">
	    <div class="tab-pane" id="tab1">
            <h2>Intro</h2>
            <h4 data-bind="text: $root.Enums.customerVideoItemType(Video().Items()[0].fk_CustomerVideoItemTypeId())"></h4>
            <h5 data-bind="text: Video().Items()[0].FootageItemName()"></h5>
            <div data-bind="foreach: TemplateScripts">
                <div class="row-fluid">
                    <div class="span12">
                        <h3 data-bind="text: Name"></h3>
                        <p data-bind="text: Description"></p>
                        <p><a class="btn" data-bind="click: function () { $root.SetActiveItemValue($data); }" href="javascript:void(0);">Select</a></p>
                    </div>
                </div>
            </div>
	    </div>
	    <div class="tab-pane" id="tab2">
            <h2>Middle</h2>
            <h4 data-bind="text: $root.Enums.customerVideoItemType(Video().Items()[1].fk_CustomerVideoItemTypeId())"></h4>
            <h5 data-bind="text: Video().Items()[1].FootageItemName()"></h5>
            <div data-bind="foreach: StockVideos">
                <div class="row-fluid">
                    <div class="span12">
                        <h3 data-bind="text: Name"></h3>
                        <p data-bind="text: Description"></p>
                        <p><a class="btn" data-bind="click: function () { $root.SetActiveItemValue($data); }" href="javascript:void(0);">Select</a></p>
                    </div>
                </div>
            </div>
	    </div>
		<div class="tab-pane" id="tab3">
            <h2>Ending</h2>
            <h4 data-bind="text: $root.Enums.customerVideoItemType(Video().Items()[2].fk_CustomerVideoItemTypeId())"></h4>
            <h5 data-bind="text: Video().Items()[2].FootageItemName()"></h5>
            <div data-bind="foreach: TemplateScripts">
                <div class="row-fluid">
                    <div class="span12">
                        <h3 data-bind="text: Name"></h3>
                        <p data-bind="text: Description"></p>
                        <p><a class="btn" data-bind="click: function () { $root.SetActiveItemValue($data); }" href="javascript:void(0);">Select</a></p>
                    </div>
                </div>
            </div>
	    </div>
		<div class="tab-pane" id="tab4">
            <h2>Audio</h2>
            <h4 data-bind="text: $root.Enums.customerVideoItemType(Video().Items()[3].fk_CustomerVideoItemTypeId())"></h4>
            <h5 data-bind="text: Video().Items()[3].FootageItemName()"></h5>
            <div data-bind="foreach: StockAudio">
                <div class="row-fluid">
                    <div class="span12">
                        <h3 data-bind="text: Name"></h3>
                        <p data-bind="text: Description"></p>
                        <p><a class="btn" data-bind="click: function () { $root.SetActiveItemValue($data); }" href="javascript:void(0);">Select</a></p>
                    </div>
                </div>
            </div>
	    </div>
		<div class="tab-pane" id="tab5">
            <h2><a class="btn" data-bind="click: function () { GenerateVideo(); }" href="javascript:void(0);">Generate!</a></h2>
	    </div>
		<ul class="pager wizard">
			<li class="previous first" style="display:none;"><a href="#">First</a></li>
			<li class="previous"><a href="#">Previous</a></li>
			<li class="next last" style="display:none;"><a href="#">Last</a></li>
		  	<li class="next"><a href="#">Next</a></li>
		</ul>
	</div>	
</div>

<hr />

<!-- ko if: ActiveItem() !== null && ActiveItem().FootageItem() !== null && ActiveItem().fk_CustomerVideoItemTypeId() === 3 -->
<div data-bind="foreach: ActiveItem().FootageItem().Items()">
    <div class="row-fluid">
        <div class="span6">
            <h3 data-bind="text: ScriptItem().Name"></h3>
            <p data-bind="text: ScriptItem().Description"></p>
        </div>
        <div class="span6">
            <!-- ko if: ScriptItem().fk_TemplateScriptItemTypeId() === 4 -->
            <label>Enter substitution text</label>
            <textarea rows="3" cols="40" data-bind="value: Value"></textarea>
            <!-- /ko -->
            <!-- ko if: ScriptItem().fk_TemplateScriptItemTypeId() !== 4 -->
            <label>
                Choose a
                <!-- ko text: $root.Enums.templateScriptItemCategory(ScriptItem().fk_TemplateScriptItemCategoryId()) --><!-- /ko -->
                <!-- ko text: $root.Enums.templateScriptItemType(ScriptItem().fk_TemplateScriptItemTypeId()) --><!-- /ko -->
            </label>
            <select data-bind="options: $root.GetMatchingResources(ScriptItem()), optionsText: 'Value', optionsValue: 'pk_CustomerResourceId', value: Value, optionsCaption: 'Choose resource...'"></select>
            <!-- /ko -->
        </div>
    </div>
</div>
<!-- /ko -->

